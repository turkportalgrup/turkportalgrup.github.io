<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>IP Lokasyon ve ASN Bilgisi</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #map { height: 400px; margin-top: 20px; }
    .info { margin-top: 20px; }
  </style>
</head>
<body>

  <h2>IP Adresi ile Lokasyon ve ASN Bilgisi</h2>
  
  <input type="text" id="ipInput" placeholder="IP adresi girin (örnek: 8.8.8.8)" />
  <button onclick="sorgulaIP()">Sorgula</button>

  <div class="info" id="ipInfo"></div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    let map, marker;

    function sorgulaIP() {
      const ip = document.getElementById('ipInput').value.trim();
      if (!ip) {
        alert("Lütfen bir IP adresi girin.");
        return;
      }

      fetch(`https://ipapi.co/${ip}/json/`)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            document.getElementById('ipInfo').innerHTML = "Hata: " + data.reason;
            return;
          }

          const infoHTML = `
            <strong>IP:</strong> ${data.ip} <br>
            <strong>Ülke:</strong> ${data.country_name} (${data.country})<br>
            <strong>Şehir:</strong> ${data.city || 'Bilinmiyor'}<br>
            <strong>Posta Kodu:</strong> ${data.postal || '-'}<br>
            <strong>Enlem:</strong> ${data.latitude}<br>
            <strong>Boylam:</strong> ${data.longitude}<br>
            <strong>ISP:</strong> ${data.org}<br>
            <strong>ASN:</strong> ${data.asn}<br>
          `;

          document.getElementById('ipInfo').innerHTML = infoHTML;

          const lat = data.latitude;
          const lon = data.longitude;

          if (!map) {
            map = L.map('map').setView([lat, lon], 10);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '&copy; OpenStreetMap katkıcıları'
            }).addTo(map);
            marker = L.marker([lat, lon]).addTo(map);
          } else {
            map.setView([lat, lon], 10);
            marker.setLatLng([lat, lon]);
          }
        })
        .catch(error => {
          document.getElementById('ipInfo').innerHTML = "Veri alınamadı: " + error;
        });
    }
  </script>
</body>
</html>
